#!/bin/bash

HDF5=..

#export HDF5_ROOT=@HDF5_ROOT_PATH@
#export LD_LIBRARY_PATH="${HDF5_ROOT}/lib:${LD_LIBRARY_PATH}"
export CC=@MPICC@
export CXX=@MPICXX@
export CFLAGS="@CFLAGS@"
export LD_LIBRARY_PATH="${HDF5}/build/lib:${LD_LIBRARY_PATH}"

cd hdf5
mkdir build
cd build

cmake $PWD/hdf5 --log-level=ERROR -C $HDF5/config/cmake/cacheinit.cmake -G "Unix Makefiles" \
-DCMAKE_INSTALL_PREFIX=$PWD/hdf5 \
-DCMAKE_VERBOSE_MAKEFILE=OFF \
-DHDF5_BUILD_FORTRAN:BOOL=OFF \
-DHDF5_BUILD_CPP_LIB:BOOL=OFF \
-DHDF5_BUILD_JAVA:BOOL=OFF \
-DHDF5_ENABLE_PARALLEL:BOOL=ON \
-DBUILD_TESTING:BOOL=ON \
-DHDF5_TEST_API:BOOL=ON \
-DHDF5_BUILD_TOOLS:BOOL=ON \
-DHDF5_BUILD_HL_LIB:BOOL=OFF \
-DBUILD_SHARED_LIBS:BOOL=ON \
$HDF5

make -j 4 install

#-DHDF5_ENABLE_Z_LIB_SUPPORT:BOOL=ON \
#-DCMAKE_INSTALL_PREFIX=$PWD/hdf5 \
